# Development Environment Configuration

spring:
  # Database Configuration for Development
  datasource:
    url: ${DB_URL:jdbc:postgresql://localhost:5432/carselling}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:your_db_password}
    hikari:
      maximum-pool-size: 10
      minimum-idle: 2
      connection-timeout: 20000
      leak-detection-threshold: 30000
      auto-commit: true

  # JPA Configuration for Development
  jpa:
    hibernate:
      ddl-auto: update # Update schema on startup to persist data
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: true

  # H2 Console (if using H2 for development)
  h2:
    console:
      enabled: false # Enable if using H2
      path: /h2-console

  # Mail Configuration for Development
  mail:
    host: smtp.gmail.com
    port: 587
    username: ${DEV_EMAIL_USERNAME:your_email@gmail.com}
    password: ${DEV_EMAIL_PASSWORD:your_email_password}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true

  # DevTools Configuration
  devtools:
    restart:
      enabled: true
    livereload:
      enabled: true
      
  # GraphQL Configuration
  graphql:
    schema:
      introspection:
        enabled: true
    graphiql:
      enabled: true
      path: /graphiql

# Server Configuration for Development
server:
  port: 9000
  error:
    include-stacktrace: always

# Logging Configuration for Development
logging:
  level:
    root: INFO
    com.carselling.oldcar: INFO
    org.springframework.security: INFO
    org.springframework.web: INFO
    org.hibernate.SQL: INFO
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    org.springframework.messaging: DEBUG # For WebSocket debugging
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# Management Configuration for Development
management:
  endpoints:
    web:
      exposure:
        include: "*" # Expose all actuator endpoints in dev
  endpoint:
    health:
      show-details: always
  health:
    mail:
      enabled: true # Disable mail health check in dev (avoids auth errors)
    redis:
      enabled: false # Disable redis health check in dev

# Application Specific Configuration for Development
app:
  # Firebase Push Notifications
  firebase:
    enabled: true
    service-account-file: carwalanotfication-firebase-adminsdk-fbsvc-6ca72dc5fe.json

  # Redis Configuration
  redis:
    enabled: false # Explicitly disable Redis to use in-memory fallback without errors

  # JWT Configuration (shorter expiration for development)
  jwt:
    secret: ${JWT_SECRET:dev-only-change-me-32-chars-minimum}
    # Consistent keys with JwtTokenProvider
    expiration-ms: 86400000 # 24 hours for development
    refresh-token-expiration-ms: 86400000 # 24 hours for development
    
  # File Upload Configuration
  upload:
    path: ./uploads/dev
    
  # Email Configuration
  email:
    enabled: true
    
  # Rate Limiting (relaxed for development)
  rate-limit:
    login-attempts: 10 # More lenient for development
    lockout-duration: 60000 # 1 minute
    otp-requests: 10
    
# Backblaze B2 Configuration
b2:
  applicationKeyId: ${B2_APPLICATION_KEY_ID}
  applicationKey: ${B2_APPLICATION_KEY}
  bucketId: ${B2_BUCKET_ID}
  bucketName: ${B2_BUCKET_NAME}
  cdnDomain: ${B2_CDN_DOMAIN}
